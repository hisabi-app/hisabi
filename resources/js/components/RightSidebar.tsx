import { useState } from 'react';
import { SparkleIcon, ChatCircleTextIcon, CubeIcon } from '@phosphor-icons/react';
import {
  SidebarMenu,
  SidebarMenuItem,
  SidebarMenuButton,
} from '@/components/ui/sidebar';
import HisabiAIChat from './Global/HisabiAIChat';
import SmsParser from './Global/SmsParser';
import McpConnection from './Global/McpConnection';

export default function RightSidebar() {
  const [activePanel, setActivePanel] = useState<'ai' | 'sms' | 'mcp' | null>(null);

  const togglePanel = (panel: 'ai' | 'sms' | 'mcp') => {
    if (activePanel === panel) {
      setActivePanel(null);
    } else {
      setActivePanel(panel);
    }
  };

  return (
    <div className="hidden md:flex h-screen bg-sidebar">
      {/* Narrow sidebar with vertical labels */}
      <div className="w-12 flex-shrink-0 bg-sidebar flex flex-col items-center pr-2 py-2 gap-1">
        <SidebarMenu>
          <SidebarMenuItem>
            <SidebarMenuButton
              onClick={() => togglePanel('ai')}
              isActive={activePanel === 'ai'}
              size="sm"
              className="flex flex-col items-center gap-1 h-auto py-3"
            >
              <SparkleIcon size={18} />
              <span 
                className="font-medium whitespace-nowrap"
                style={{ writingMode: 'vertical-lr', transform: 'rotate(0deg)' }}
              >
                Hisabi AI (BETA)
              </span>
            </SidebarMenuButton>
          </SidebarMenuItem>
                    
          <SidebarMenuItem>
            <SidebarMenuButton
              onClick={() => togglePanel('sms')}
              isActive={activePanel === 'sms'}
              size="sm"
              className="flex flex-col items-center gap-1 h-auto py-3"
            >
              <ChatCircleTextIcon size={18} />
              <span 
                className="font-medium whitespace-nowrap"
                style={{ writingMode: 'vertical-lr', transform: 'rotate(0deg)' }}
              >
                SMS Parser
              </span>
            </SidebarMenuButton>
          </SidebarMenuItem>

          {/* <SidebarMenuItem>
            <SidebarMenuButton
              onClick={() => togglePanel('mcp')}
              isActive={activePanel === 'mcp'}
              size="sm"
              className="flex flex-col items-center gap-1 h-auto py-3"
            >
              <CubeIcon className="w-[18px] h-[18px]" />
              <span 
                className="font-medium whitespace-nowrap"
                style={{ writingMode: 'vertical-lr', transform: 'rotate(0deg)' }}
              >
                MCP
              </span>
            </SidebarMenuButton>
          </SidebarMenuItem> */}
        </SidebarMenu>
      </div>

      {/* Expandable content panel */}
      <div className={`overflow-hidden transition-all duration-300 ease-in-out border-l ${
        activePanel ? 'w-[400px]' : 'w-0'
      }`}>
        {activePanel === 'ai' && <HisabiAIChat onClose={() => setActivePanel(null)} />}
        {activePanel === 'mcp' && <McpConnection onClose={() => setActivePanel(null)} />}
        {activePanel === 'sms' && <SmsParser onClose={() => setActivePanel(null)} />}
      </div>
    </div>
  );
}

